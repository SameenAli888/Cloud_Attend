<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CloudAttend - Smart Attendance Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ------------------------- Global Styles ------------------------- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            min-height: 100vh;
            overflow-x: hidden;
            background-color: #f8f9fa;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        button {
            cursor: pointer;
            border: none;
            outline: none;
            border-radius: 5px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

            button:hover {
                transform: translateY(-2px);
            }

        /* ------------------------- Enhanced First Page ------------------------- */
        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            z-index: 2;
            position: relative;
            padding: 20px;
        }

        #home {
            background-image: url('https://z-cdn-media.chatglm.cn/files/8b54109b-6fbb-439a-ada4-3b2eeceaf5c2_Screenshot%202025-11-11%20174422.png?auth_key=1862868856-424f601e25cd4f948a3364d36868597b-0-daa85787b9ffa59c4288b8a2a6d3e7f0');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            position: relative;
        }

            #home::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, rgba(30, 87, 123, 0.7), rgba(45, 190, 207, 0.5));
                z-index: 1;
            }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            margin: 10px;
            width: 90%;
            max-width: 800px;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            z-index: 3;
            overflow: hidden;
        }

            .card::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 5px;
                background: linear-gradient(90deg, #1E577B, #2DBECF, #89A7BA);
            }

            .card:hover {
                transform: translateY(-10px);
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
            }

        .logo-section {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

            .logo-section .logo-img {
                max-width: 100px;
                margin-bottom: 15px;
                filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.1));
                animation: float 6s ease-in-out infinite;
            }

        @keyframes float {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-5px);
            }

            100% {
                transform: translateY(0px);
            }
        }

        .logo-section h1 {
            font-size: 3.5rem;
            margin-bottom: 10px;
            color: #1a2a6c;
            font-weight: 700;
            letter-spacing: -1px;
            position: relative;
            display: inline-block;
            background: linear-gradient(45deg, #1E577B, #2DBECF);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 10px rgba(30, 87, 123, 0.2);
        }

            .logo-section h1::after {
                content: '';
                position: absolute;
                bottom: -8px;
                left: 50%;
                transform: translateX(-50%);
                width: 60px;
                height: 3px;
                background: linear-gradient(90deg, #1E577B, #2DBECF);
                border-radius: 2px;
            }

        .logo-section p {
            font-size: 1.2rem;
            color: #555;
            font-weight: 400;
            margin-top: 12px;
            letter-spacing: 0.5px;
            position: relative;
        }

        .role-icons {
            display: flex;
            justify-content: center;
            gap: 60px;
            margin: 40px 0;
        }

        .role-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s ease;
            position: relative;
        }

            .role-icon:hover {
                transform: translateY(-10px);
            }

        .icon-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

            .icon-circle::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(255, 255, 255, 0.2);
                border-radius: 50%;
                transform: scale(0);
                transition: transform 0.5s ease;
            }

        .role-icon:hover .icon-circle::before {
            transform: scale(1);
        }

        .role-icon:hover .icon-circle {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }

        .icon-circle i {
            font-size: 3rem;
            color: white;
            z-index: 1;
            transition: all 0.3s ease;
        }

        .role-icon:hover .icon-circle i {
            transform: scale(1.1);
        }

        .role-label {
            font-size: 1.2rem;
            font-weight: 600;
            color: #333;
            margin-top: 8px;
            position: relative;
        }

            .role-label::after {
                content: '';
                position: absolute;
                bottom: -6px;
                left: 50%;
                transform: translateX(-50%);
                width: 0;
                height: 2px;
                background: linear-gradient(90deg, #1E577B, #2DBECF);
                border-radius: 1px;
                transition: width 0.3s ease;
            }

        .role-icon:hover .role-label::after {
            width: 30px;
        }

        .student-icon {
            background: linear-gradient(45deg, #1E577B, #2a7ba3);
        }

        .faculty-icon {
            background: linear-gradient(45deg, #2DBECF, #4dd5e5);
        }

        .admin-icon {
            background: linear-gradient(45deg, #89A7BA, #a5c0d1);
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9rem;
            position: relative;
            z-index: 3;
        }

            .footer p {
                position: relative;
                display: inline-block;
            }

                .footer p::before {
                    content: '';
                    position: absolute;
                    top: -8px;
                    left: 50%;
                    transform: translateX(-50%);
                    width: 30px;
                    height: 1.5px;
                    background: linear-gradient(90deg, #1E577B, #2DBECF);
                    border-radius: 1px;
                }

        /* Add a subtle animation to the card */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .card {
            animation: fadeInUp 0.8s ease-out;
        }

        /* Add a glowing effect to the role icons on hover */
        .role-icon:hover .icon-circle {
            box-shadow: 0 0 20px rgba(30, 87, 123, 0.5);
        }

        /* Add a pulse animation to the role icons */
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(30, 87, 123, 0.4);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(30, 87, 123, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(30, 87, 123, 0);
            }
        }

        .role-icon:hover .icon-circle {
            animation: pulse 1.5s infinite;
        }

        /* ------------------------- Login Page Styles ------------------------- */
        #login {
            background: linear-gradient(135deg, #1E577B, #2DBECF);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: row;
            width: 100%;
            min-height: 100vh;
        }

            #login::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url('https://images.pexels.com/photos/459451/pexels-photo-459451.jpeg');
                background-size: cover;
                background-position: center;
                opacity: 0.5;
                z-index: 1;
            }

        /* Split screen layout */
        .login-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            position: relative;
            z-index: 2;
            color: white;
            text-align: center;
        }

        .login-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            position: relative;
            z-index: 2;
        }

        /* Left side styling */
        .login-left .logo-img {
            max-width: 120px;
            margin-bottom: 20px;
            filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
        }

        .login-left h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: white;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .login-left p {
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 400px;
            line-height: 1.6;
        }

        /* Right side styling */
        #login .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            max-width: 400px;
            width: 100%;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #login .logo-section {
            margin-bottom: 30px;
        }

            #login .logo-section .logo-img {
                max-width: 60px;
            }

            #login .logo-section h2 {
                font-size: 2rem;
                color: #1E577B;
                margin-bottom: 10px;
                text-shadow: none;
            }

        #login .login-form {
            margin: 10px 0;
            width: 100%;
        }

            #login .login-form input {
                padding: 12px;
                margin: 8px 0;
                border: 1px solid rgba(30, 87, 123, 0.3);
                border-radius: 20px;
                font-size: 0.9rem;
                background: rgba(255, 255, 255, 0.8);
                color: #333;
                transition: all 0.3s ease;
                width: 100%;
            }

                #login .login-form input::placeholder {
                    color: rgba(30, 87, 123, 0.7);
                }

                #login .login-form input:focus {
                    border-color: rgba(30, 87, 123, 0.5);
                    background: rgba(255, 255, 255, 0.9);
                    box-shadow: 0 0 0 2px rgba(30, 87, 123, 0.2);
                    outline: none;
                }

            /* Enhanced Login Buttons */
            #login .login-form .btn-container {
                display: flex;
                flex-direction: column;
                gap: 10px;
                margin-top: 20px;
            }

            #login .login-form button {
                padding: 12px 15px;
                font-weight: 600;
                font-size: 0.9rem;
                border-radius: 20px;
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 8px;
            }

                #login .login-form button::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: -100%;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(90deg, transparent, rgba(30, 87, 123, 0.3), transparent);
                    transition: left 0.5s;
                }

                #login .login-form button:hover::before {
                    left: 100%;
                }

            #login .login-form .btn-signin {
                background: linear-gradient(45deg, #1E577B, #2DBECF);
                color: white;
                border: none;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }

                #login .login-form .btn-signin:hover {
                    background: linear-gradient(45deg, #2a7ba3, #4dd5e5);
                    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
                    transform: translateY(-3px);
                }

            #login .login-form .btn-back {
                background: white;
                color: #1E577B;
                border: 1px solid rgba(30, 87, 123, 0.3);
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            }

                #login .login-form .btn-back:hover {
                    background: #f8f9fa;
                    border-color: rgba(30, 87, 123, 0.4);
                    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
                    transform: translateY(-3px);
                }

        /* Register link */
        .register-link {
            margin-top: 15px;
            font-size: 0.9rem;
            color: #555;
            text-align: center;
        }

            .register-link a {
                color: #1E577B;
                font-weight: 600;
                text-decoration: none;
                transition: color 0.3s ease;
            }

                .register-link a:hover {
                    color: #2DBECF;
                    text-decoration: underline;
                }

        /* Copyright info */
        .login-copyright {
            position: absolute;
            bottom: 20px;
            left: 0;
            width: 100%;
            text-align: center;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.8rem;
            z-index: 2;
        }

        /* Water droplets effect for login page */
        .droplet {
            position: absolute;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, rgba(30,190,207,0.4) 70%);
            border-radius: 50%;
            z-index: 1;
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% {
                transform: translateY(-100px);
                opacity: 1;
            }

            100% {
                transform: translateY(100vh);
                opacity: 0;
            }
        }

        /* ------------------------- Dashboards ------------------------- */
        .dashboard {
            display: none;
            min-height: 100vh;
            flex-direction: row;
            transition: 0.3s;
            background-color: #f8f9fa;
            position: relative;
        }

            .dashboard::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle at 10% 20%, rgba(30, 87, 123, 0.05) 0%, rgba(45, 190, 207, 0.05) 90%);
                z-index: 0;
            }

        .sidebar {
            width: 220px;
            background: #1E577B;
            color: white;
            padding: 20px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            transition: 0.3s;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }

            .sidebar::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(180deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 100%);
                z-index: -1;
            }

            .sidebar.collapsed {
                width: 60px;
            }

            .sidebar h2, .sidebar a span {
                display: inline-block;
                transition: 0.3s;
            }

            .sidebar.collapsed h2, .sidebar.collapsed a span {
                display: none;
            }

            .sidebar a {
                padding: 12px 5px;
                margin: 5px 0;
                border-radius: 5px;
                display: flex;
                align-items: center;
                color: white;
                transition: all 0.3s ease;
                position: relative;
                overflow: hidden;
            }

                .sidebar a::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    width: 3px;
                    height: 100%;
                    background: rgba(255, 255, 255, 0.7);
                    transform: translateX(-100%);
                    transition: transform 0.3s ease;
                }

                .sidebar a:hover::before {
                    transform: translateX(0);
                }

                .sidebar a:hover {
                    background: rgba(255,255,255,0.2);
                    padding-left: 15px;
                }

                .sidebar a.active {
                    background: rgba(255,255,255,0.3);
                    box-shadow: 0 0 10px rgba(255,255,255,0.2);
                }

                .sidebar a i {
                    margin-right: 10px;
                    font-size: 1.2rem;
                    transition: transform 0.3s ease;
                }

                .sidebar a:hover i {
                    transform: scale(1.2);
                }

        .sidebar-toggle {
            margin-bottom: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            padding: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            border-radius: 5px;
            text-align: center;
            transition: all 0.3s ease;
        }

            .sidebar-toggle:hover {
                background: rgba(255,255,255,0.3);
                transform: scale(1.05);
            }

        .main {
            flex: 1;
            padding: 30px;
            background: #ffffff;
            border-radius: 10px;
            margin: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

            .main::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 5px;
                background: linear-gradient(90deg, #1E577B, #2DBECF, #89A7BA);
            }

        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }

            .content-section.active {
                display: block;
            }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Role Colors */
        .student .sidebar {
            background: linear-gradient(180deg, #1E577B, #2a7ba3);
        }

        .faculty .sidebar {
            background: linear-gradient(180deg, #2DBECF, #4dd5e5);
        }

        .admin .sidebar {
            background: linear-gradient(180deg, #89A7BA, #a5c0d1);
        }

        /* ------------------------- Responsive ------------------------- */
        @media(max-width:768px) {
            .dashboard {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                flex-direction: row;
                overflow-x: auto;
            }

                .sidebar a {
                    flex: 1;
                    text-align: center;
                }

            .role-icons {
                flex-direction: column;
                gap: 30px;
            }

            .logo-section h1 {
                font-size: 2.5rem;
            }

            /* Adjust login card for mobile */
            #login {
                flex-direction: column;
            }

            .login-left, .login-right {
                flex: none;
                width: 100%;
            }

            #login .card {
                width: 90%;
                padding: 30px;
            }
        }

        /* ------------------------- Content Styles ------------------------- */
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .content-title {
            font-size: 1.8rem;
            color: #333;
            position: relative;
        }

            .content-title::after {
                content: '';
                position: absolute;
                bottom: -5px;
                left: 0;
                width: 40px;
                height: 3px;
                background: linear-gradient(90deg, #1E577B, #2DBECF);
                border-radius: 2px;
            }

        .content-actions button {
            padding: 8px 15px;
            margin-left: 10px;
            background: linear-gradient(45deg, #1a2a6c, #2a4298);
            color: white;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

            .content-actions button:hover {
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

            .data-table th, .data-table td {
                padding: 12px;
                text-align: left;
                border-bottom: 1px solid #ddd;
            }

            .data-table th {
                background-color: #f2f2f2;
                font-weight: 600;
                color: #333;
                position: sticky;
                top: 0;
            }

            .data-table tr {
                transition: background-color 0.3s ease;
            }

                .data-table tr:hover {
                    background-color: #f5f5f5;
                }

                .data-table tr:last-child td {
                    border-bottom: none;
                }

        .stat-cards {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            flex: 1;
            min-width: 200px;
            border: 1px solid #e9ecef;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

            .stat-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            }

            .stat-card:before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                width: 5px;
                height: 100%;
                background: linear-gradient(45deg, #1a2a6c, #4a6bdf);
            }

            .stat-card h3 {
                margin-bottom: 10px;
                color: #555;
                font-size: 1rem;
                font-weight: 500;
            }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #1a2a6c;
            position: relative;
            display: inline-block;
        }

            .stat-value::after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 2px;
                background: linear-gradient(90deg, #1E577B, #2DBECF);
                transform: scaleX(0);
                transform-origin: left;
                transition: transform 0.3s ease;
            }

        .stat-card:hover .stat-value::after {
            transform: scaleX(1);
        }

        .announcement-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
            border-left: 4px solid #1a2a6c;
            transition: all 0.3s ease;
        }

            .announcement-item:hover {
                transform: translateX(5px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }

        .announcement-date {
            color: #777;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }

        .notification-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-bottom: 1px solid #eee;
            background: white;
            border-left: 3px solid transparent;
            transition: all 0.3s ease;
        }

            .notification-item:hover {
                border-left: 3px solid #1a2a6c;
                background-color: #f9f9f9;
            }

        .notification-icon {
            margin-right: 15px;
            color: #1a2a6c;
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .notification-item:hover .notification-icon {
            transform: scale(1.2);
        }

        .notification-content {
            flex: 1;
        }

        .notification-time {
            color: #777;
            font-size: 0.8rem;
        }

        .form-group {
            margin-bottom: 15px;
        }

            .form-group label {
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
                color: #333;
            }

            .form-group input, .form-group select, .form-group textarea {
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 5px;
                transition: all 0.3s ease;
            }

                .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
                    border-color: #1a2a6c;
                    outline: none;
                    box-shadow: 0 0 0 2px rgba(26, 42, 108, 0.2);
                }

            .form-group textarea {
                height: 100px;
                resize: vertical;
            }

        /* Enhanced button styles */
        .btn-primary {
            background: linear-gradient(45deg, #1a2a6c, #2a4298);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 500;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            }

        .btn-secondary {
            background: white;
            color: #1a2a6c;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 500;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 1px solid #1a2a6c;
            transition: all 0.3s ease;
        }

            .btn-secondary:hover {
                background: #f8f9fa;
                transform: translateY(-2px);
                box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Floating particles effect */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }

        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            pointer-events: none;
            opacity: 0;
            animation: float-particle 15s infinite;
        }

        @keyframes float-particle {
            0% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }

            10% {
                opacity: 0.4;
            }

            90% {
                opacity: 0.4;
            }

            100% {
                transform: translateY(-100vh) scale(1);
                opacity: 0;
            }
        }

        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }

            .tooltip .tooltiptext {
                visibility: hidden;
                width: 120px;
                background-color: #555;
                color: #fff;
                text-align: center;
                border-radius: 6px;
                padding: 5px;
                position: absolute;
                z-index: 1;
                bottom: 125%;
                left: 50%;
                margin-left: -60px;
                opacity: 0;
                transition: opacity 0.3s;
            }

            .tooltip:hover .tooltiptext {
                visibility: visible;
                opacity: 1;
            }

        /* Progress bar styles */
        .progress {
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #1E577B, #2DBECF);
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        /* Badge styles */
        .badge {
            display: inline-block;
            padding: 3px 7px;
            font-size: 0.75rem;
            font-weight: 700;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: 10px;
        }

        .badge-success {
            color: #fff;
            background-color: #28a745;
        }

        .badge-warning {
            color: #212529;
            background-color: #ffc107;
        }

        .badge-danger {
            color: #fff;
            background-color: #dc3545;
        }

        .badge-info {
            color: #fff;
            background-color: #17a2b8;
        }

        /* Ripple effect */
        .ripple {
            position: absolute;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            transform: scale(0);
            animation: ripple-animation 0.6s linear;
            pointer-events: none;
        }

        @keyframes ripple-animation {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            animation: fadeIn 0.3s;
        }

        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.5rem;
            color: #333;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

            .close:hover {
                color: #333;
            }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Video player styles */
        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
        }

            .video-container video {
                width: 100%;
                border-radius: 8px;
            }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            z-index: 10;
        }

            .video-overlay.hidden {
                display: none;
            }

        .video-message {
            color: white;
            font-size: 1.2rem;
            text-align: center;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 8px;
            max-width: 80%;
        }
    </style>
</head>
<body>
    <div class="container" id="home">
        <div class="particles" id="home-particles"></div>
        <div class="card">
            <div class="logo-section">
                <img src="C:\Users\Noman Traders\Downloads\CloudAttend-logo-without-bg.png" alt="CloudAttend Logo" class="logo-img">
                <h1>CloudAttend</h1>
            </div>

            <div class="role-icons">
                <div class="role-icon" onclick="showLogin('faculty')">
                    <div class="icon-circle faculty-icon">
                        <i class="fas fa-chalkboard-teacher"></i>
                    </div>
                    <div class="role-label">FACULTY</div>
                </div>

                <div class="role-icon" onclick="showLogin('student')">
                    <div class="icon-circle student-icon">
                        <i class="fas fa-user-graduate"></i>
                    </div>
                    <div class="role-label">STUDENT</div>
                </div>

                <div class="role-icon" onclick="showLogin('admin')">
                    <div class="icon-circle admin-icon">
                        <i class="fas fa-user-cog"></i>
                    </div>
                    <div class="role-label">ADMIN</div>
                </div>
            </div>
            <div class="footer">
                <p>&copy; 2025 CloudAttend. Empowering Smart Attendance Solutions.</p>
            </div>
        </div>
    </div>

    <!-- Login Forms -->
    <div class="container" id="login" style="display:none;">
        <!-- Water droplets will be added dynamically here -->
        <!-- Left side with branding -->
        <div class="login-left">
            <img src="C:\Users\Noman Traders\Downloads\CloudAttend-logo-without-bg.png" alt="CloudAttend Logo" class="logo-img">
            <h1>CloudAttend</h1>
            <p>Empowering Smart Attendance Solutions</p>
        </div>

        <!-- Right side with login form -->
        <div class="login-right">
            <div class="card">
                <div class="logo-section">
                    <h2 id="login-title"></h2>
                </div>
                <div class="login-form">
                    <input type="text" placeholder="Username" id="email">
                    <input type="password" placeholder="Password" id="password">
                    <div class="btn-container">
                        <button class="btn-signin" onclick="login()">
                            <i class="fas fa-sign-in-alt"></i> Login
                        </button>
                        <button class="btn-back" onclick="backHome()">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                    </div>
                    <div class="register-link">
                        Don't have an account? <a href="#" onclick="showRegisterForm()">Register Now</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Copyright information -->
        <div class="login-copyright">
            <p>&copy; 2025 CloudAttend. All rights reserved.</p>
        </div>
    </div>

    <!-- Student Dashboard -->
    <div class="dashboard student" id="student-dashboard">
        <div class="sidebar" id="student-sidebar">
            <div class="sidebar-toggle" onclick="toggleSidebar('student')">&#9776;</div>
            <h2>Student</h2>
            <a href="#" onclick="showContent('student', 'dashboard')" class="active"><span><i class="fas fa-tachometer-alt"></i> Dashboard</span></a>
            <a href="#" onclick="showContent('student', 'live-lectures')"><span><i class="fas fa-video"></i> Live Lectures</span></a>
            <a href="#" onclick="showContent('student', 'recorded-lectures')"><span><i class="fas fa-play-circle"></i> Recorded Lectures</span></a>
            <a href="#" onclick="showContent('student', 'attendance')"><span><i class="fas fa-calendar-check"></i> Attendance</span></a>
            <a href="#" onclick="showContent('student', 'announcements')"><span><i class="fas fa-bullhorn"></i> Announcements</span></a>
            <a href="#" onclick="showContent('student', 'notifications')"><span><i class="fas fa-bell"></i> Notifications</span></a>
            <a href="#" onclick="showContent('student', 'settings')"><span><i class="fas fa-cog"></i> Settings</span></a>
            <a href="#" onclick="logout()"><span><i class="fas fa-sign-out-alt"></i> Logout</span></a>
        </div>
        <div class="main">
            <!-- Dashboard Content -->
            <div id="student-dashboard-content" class="content-section active">
                <div class="content-header">
                    <h2 class="content-title">Student Dashboard</h2>
                    <div class="content-actions">
                        <button onclick="refreshDashboard('student')"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Overall Attendance</h3>
                        <div class="stat-value" id="student-attendance-percentage">-</div>
                        <div class="progress">
                            <div class="progress-bar" id="student-attendance-progress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>Courses Enrolled</h3>
                        <div class="stat-value" id="student-courses-count">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Upcoming Lectures</h3>
                        <div class="stat-value" id="student-upcoming-lectures">-</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Recent Activity</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Date</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="student-recent-activity">
                        <tr>
                            <td colspan="3" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Live Lectures Content -->
            <div id="student-live-lectures-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Live Lectures</h2>
                    <div class="content-actions">
                        <button onclick="filterLectures()"><i class="fas fa-filter"></i> Filter</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Today's Lectures</h3>
                        <div class="stat-value" id="student-today-lectures">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>This Week</h3>
                        <div class="stat-value" id="student-week-lectures">-</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Upcoming Live Lectures</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Time</th>
                            <th>Faculty</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="student-upcoming-lectures-table">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Recorded Lectures Content -->
            <div id="student-recorded-lectures-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Recorded Lectures</h2>
                    <div class="content-actions">
                        <button onclick="searchLectures()"><i class="fas fa-search"></i> Search</button>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Recently Recorded</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Date</th>
                            <th>Duration</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="student-recorded-lectures-table">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Attendance Content -->
            <div id="student-attendance-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Attendance</h2>
                    <div class="content-actions">
                        <button onclick="downloadAttendanceReport()"><i class="fas fa-download"></i> Download Report</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>This Semester</h3>
                        <div class="stat-value" id="student-semester-attendance">-</div>
                        <div class="progress">
                            <div class="progress-bar" id="student-semester-progress" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <h3>Classes Attended</h3>
                        <div class="stat-value" id="student-classes-attended">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Attendance Status</h3>
                        <div class="stat-value" id="student-attendance-status">-</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Course-wise Attendance</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Classes Held</th>
                            <th>Attended</th>
                            <th>Percentage</th>
                        </tr>
                    </thead>
                    <tbody id="student-course-attendance">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Announcements Content -->
            <div id="student-announcements-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Announcements</h2>
                    <div class="content-actions">
                        <button onclick="createAnnouncement()"><i class="fas fa-plus"></i> New Announcement</button>
                    </div>
                </div>

                <div id="student-announcements-list">
                    <div class="announcement-item">
                        <div class="announcement-date">Loading announcements...</div>
                        <h3>Please wait</h3>
                        <p>We are fetching the latest announcements for you.</p>
                    </div>
                </div>
            </div>

            <!-- Notifications Content -->
            <div id="student-notifications-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Notifications</h2>
                    <div class="content-actions">
                        <button onclick="markAllAsRead()"><i class="fas fa-check-double"></i> Mark All Read</button>
                    </div>
                </div>

                <div id="student-notifications-list">
                    <div class="notification-item">
                        <div class="notification-icon"><i class="fas fa-spinner fa-spin"></i></div>
                        <div class="notification-content">
                            <h4>Loading notifications</h4>
                            <p>Please wait while we fetch your notifications.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Content -->
            <div id="student-settings-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Settings</h2>
                </div>

                <h3 style="margin-bottom: 15px;">Profile Settings</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="student-name" value="">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="student-email" value="">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="student-phone" value="">
                </div>

                <h3 style="margin: 20px 0 15px;">Notification Preferences</h3>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="email-notifications" checked> Email Notifications
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="sms-notifications" checked> SMS Notifications
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="push-notifications"> Push Notifications
                    </label>
                </div>

                <button class="btn-primary" style="margin-top: 20px;" onclick="saveStudentSettings()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Faculty Dashboard -->
    <div class="dashboard faculty" id="faculty-dashboard">
        <div class="sidebar" id="faculty-sidebar">
            <div class="sidebar-toggle" onclick="toggleSidebar('faculty')">&#9776;</div>
            <h2>Faculty</h2>
            <a href="#" onclick="showContent('faculty', 'dashboard')" class="active"><span><i class="fas fa-tachometer-alt"></i> Dashboard</span></a>
            <a href="#" onclick="showContent('faculty', 'lecture-upload')"><span><i class="fas fa-upload"></i> Lecture Upload</span></a>
            <a href="#" onclick="showContent('faculty', 'attendance-management')"><span><i class="fas fa-user-check"></i> Attendance Management</span></a>
            <a href="#" onclick="showContent('faculty', 'assignments-quiz')"><span><i class="fas fa-tasks"></i> Assignments & Quiz</span></a>
            <a href="#" onclick="showContent('faculty', 'announcements')"><span><i class="fas fa-bullhorn"></i> Announcements</span></a>
            <a href="#" onclick="showContent('faculty', 'notifications')"><span><i class="fas fa-bell"></i> Notifications</span></a>
            <a href="#" onclick="logout()"><span><i class="fas fa-sign-out-alt"></i> Logout</span></a>
        </div>
        <div class="main">
            <!-- Dashboard Content -->
            <div id="faculty-dashboard-content" class="content-section active">
                <div class="content-header">
                    <h2 class="content-title">Faculty Dashboard</h2>
                    <div class="content-actions">
                        <button onclick="refreshDashboard('faculty')"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Courses</h3>
                        <div class="stat-value" id="faculty-courses-count">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Students</h3>
                        <div class="stat-value" id="faculty-students-count">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Avg Attendance</h3>
                        <div class="stat-value" id="faculty-avg-attendance">-</div>
                        <div class="progress">
                            <div class="progress-bar" id="faculty-attendance-progress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Today's Schedule</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Course</th>
                            <th>Room</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="faculty-today-schedule">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Lecture Upload Content -->
            <div id="faculty-lecture-upload-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Lecture Upload</h2>
                </div>

                <h3 style="margin-bottom: 15px;">Upload New Lecture</h3>
                <div class="form-group">
                    <label>Course</label>
                    <select id="lecture-course">
                        <option value="">Select a course</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Lecture Title</label>
                    <input type="text" id="lecture-title" placeholder="Enter lecture title">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="lecture-description" placeholder="Enter lecture description"></textarea>
                </div>
                <div class="form-group">
                    <label>Lecture Video</label>
                    <input type="file" id="lecture-video">
                </div>
                <div class="form-group">
                    <label>Resources (Optional)</label>
                    <input type="file" id="lecture-resources" multiple>
                </div>
                <button class="btn-primary" onclick="uploadLecture()">Upload Lecture</button>

                <h3 style="margin: 30px 0 15px;">Recently Uploaded</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Course</th>
                            <th>Date</th>
                            <th>Views</th>
                        </tr>
                    </thead>
                    <tbody id="faculty-recent-lectures">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Attendance Management Content -->
            <div id="faculty-attendance-management-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Attendance Management</h2>
                    <div class="content-actions">
                        <button onclick="markAttendance()"><i class="fas fa-plus"></i> Mark Attendance</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Today's Classes</h3>
                        <div class="stat-value" id="faculty-today-classes">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Students</h3>
                        <div class="stat-value" id="faculty-total-students">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Avg Attendance</h3>
                        <div class="stat-value" id="faculty-avg-attendance-value">-</div>
                        <div class="progress">
                            <div class="progress-bar" id="faculty-avg-attendance-progress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Attendance Records</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Course</th>
                            <th>Date</th>
                            <th>Total Students</th>
                            <th>Present</th>
                            <th>Absent</th>
                            <th>Percentage</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="faculty-attendance-records">
                        <tr>
                            <td colspan="7" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Assignments & Quiz Content -->
            <div id="faculty-assignments-quiz-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Assignments & Quiz Creation</h2>
                    <div class="content-actions">
                        <button onclick="createAssignment()"><i class="fas fa-plus"></i> Create New</button>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Create New Assignment</h3>
                <div class="form-group">
                    <label>Course</label>
                    <select id="assignment-course">
                        <option value="">Select a course</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="assignment-title" placeholder="Enter assignment title">
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="assignment-description" placeholder="Enter assignment description"></textarea>
                </div>
                <div class="form-group">
                    <label>Due Date</label>
                    <input type="date" id="assignment-due-date">
                </div>
                <div class="form-group">
                    <label>Attachments (Optional)</label>
                    <input type="file" id="assignment-attachments" multiple>
                </div>
                <button class="btn-primary" onclick="submitAssignment()">Create Assignment</button>

                <h3 style="margin: 30px 0 15px;">Active Assignments</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Course</th>
                            <th>Due Date</th>
                            <th>Submissions</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="faculty-active-assignments">
                        <tr>
                            <td colspan="5" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Announcements Content -->
            <div id="faculty-announcements-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Announcements</h2>
                    <div class="content-actions">
                        <button onclick="createFacultyAnnouncement()"><i class="fas fa-plus"></i> New Announcement</button>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Create New Announcement</h3>
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="faculty-announcement-title" placeholder="Enter announcement title">
                </div>
                <div class="form-group">
                    <label>Message</label>
                    <textarea id="faculty-announcement-message" placeholder="Enter announcement message"></textarea>
                </div>
                <div class="form-group">
                    <label>Target Audience</label>
                    <select id="faculty-announcement-audience">
                        <option>All Students</option>
                        <option>Specific Course</option>
                    </select>
                </div>
                <div class="form-group" id="faculty-announcement-course-group" style="display: none;">
                    <label>Course</label>
                    <select id="faculty-announcement-course">
                        <option value="">Select a course</option>
                    </select>
                </div>
                <button class="btn-primary" onclick="postFacultyAnnouncement()">Post Announcement</button>

                <h3 style="margin: 30px 0 15px;">Recent Announcements</h3>
                <div id="faculty-announcements-list">
                    <div class="announcement-item">
                        <div class="announcement-date">Loading announcements...</div>
                        <h3>Please wait</h3>
                        <p>We are fetching the latest announcements for you.</p>
                    </div>
                </div>
            </div>

            <!-- Notifications Content -->
            <div id="faculty-notifications-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Notifications</h2>
                    <div class="content-actions">
                        <button onclick="markFacultyNotificationsAsRead()"><i class="fas fa-check-double"></i> Mark All Read</button>
                    </div>
                </div>

                <div id="faculty-notifications-list">
                    <div class="notification-item">
                        <div class="notification-icon"><i class="fas fa-spinner fa-spin"></i></div>
                        <div class="notification-content">
                            <h4>Loading notifications</h4>
                            <p>Please wait while we fetch your notifications.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="dashboard admin" id="admin-dashboard">
        <div class="sidebar" id="admin-sidebar">
            <div class="sidebar-toggle" onclick="toggleSidebar('admin')">&#9776;</div>
            <h2>Admin</h2>
            <a href="#" onclick="showContent('admin', 'dashboard')" class="active"><span><i class="fas fa-tachometer-alt"></i> Dashboard</span></a>
            <a href="#" onclick="showContent('admin', 'users')"><span><i class="fas fa-users"></i> Users</span></a>
            <a href="#" onclick="showContent('admin', 'administrators')"><span><i class="fas fa-user-shield"></i> Administrators</span></a>
            <a href="#" onclick="showContent('admin', 'database')"><span><i class="fas fa-database"></i> Database</span></a>
            <a href="#" onclick="showContent('admin', 'notifications')"><span><i class="fas fa-bell"></i> Notifications</span></a>
            <a href="#" onclick="showContent('admin', 'settings')"><span><i class="fas fa-cog"></i> Settings</span></a>
            <a href="#" onclick="logout()"><span><i class="fas fa-sign-out-alt"></i> Logout</span></a>
        </div>
        <div class="main">
            <!-- Dashboard Content -->
            <div id="admin-dashboard-content" class="content-section active">
                <div class="content-header">
                    <h2 class="content-title">Admin Dashboard</h2>
                    <div class="content-actions">
                        <button onclick="refreshDashboard('admin')"><i class="fas fa-sync-alt"></i> Refresh</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Total Users</h3>
                        <div class="stat-value" id="admin-total-users">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Students</h3>
                        <div class="stat-value" id="admin-students-count">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Faculty</h3>
                        <div class="stat-value" id="admin-faculty-count">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Administrators</h3>
                        <div class="stat-value" id="admin-admins-count">-</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">System Overview</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Status</th>
                            <th>Last Updated</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="admin-system-overview">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Users Content -->
            <div id="admin-users-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Users</h2>
                    <div class="content-actions">
                        <button onclick="addUser()"><i class="fas fa-plus"></i> Add User</button>
                        <button onclick="exportUsers()"><i class="fas fa-file-export"></i> Export</button>
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <input type="text" id="user-search" placeholder="Search users..." style="width: 300px; padding: 8px;">
                    <button class="btn-primary" style="margin-left: 10px;" onclick="searchUsers()">Search</button>
                </div>

                <table id="admin-users-table" class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Phone</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="6" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Administrators Content -->
            <div id="admin-administrators-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Administrators</h2>
                    <div class="content-actions">
                        <button onclick="addAdministrator()"><i class="fas fa-plus"></i> Add Administrator</button>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Add New Administrator</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="admin-name" placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="admin-email" placeholder="Enter email address">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="admin-role">
                        <option>Super Admin</option>
                        <option>Department Admin</option>
                        <option>Support Admin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Permissions</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                        <label style="display: flex; align-items: center; width: 200px;">
                            <input type="checkbox" id="perm-user-mgmt" style="margin-right: 5px;"> User Management
                        </label>
                        <label style="display: flex; align-items: center; width: 200px;">
                            <input type="checkbox" id="perm-sys-config" style="margin-right: 5px;"> System Configuration
                        </label>
                        <label style="display: flex; align-items: center; width: 200px;">
                            <input type="checkbox" id="perm-db-access" style="margin-right: 5px;"> Database Access
                        </label>
                        <label style="display: flex; align-items: center; width: 200px;">
                            <input type="checkbox" id="perm-report-gen" style="margin-right: 5px;"> Report Generation
                        </label>
                    </div>
                </div>
                <button class="btn-primary" onclick="submitAdministrator()">Add Administrator</button>

                <h3 style="margin: 30px 0 15px;">Current Administrators</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Role</th>
                            <th>Last Login</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="admin-administrators-table">
                        <tr>
                            <td colspan="5" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Database Content -->
            <div id="admin-database-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Database</h2>
                    <div class="content-actions">
                        <button onclick="backupDatabase()"><i class="fas fa-database"></i> Backup Now</button>
                        <button onclick="restoreDatabase()"><i class="fas fa-upload"></i> Restore</button>
                    </div>
                </div>

                <div class="stat-cards">
                    <div class="stat-card">
                        <h3>Database Size</h3>
                        <div class="stat-value" id="admin-db-size">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Last Backup</h3>
                        <div class="stat-value" id="admin-last-backup">-</div>
                    </div>
                    <div class="stat-card">
                        <h3>Backup Status</h3>
                        <div class="stat-value" id="admin-backup-status">-</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px;">Database Tables</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Table Name</th>
                            <th>Records</th>
                            <th>Size</th>
                            <th>Last Modified</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="admin-db-tables">
                        <tr>
                            <td colspan="5" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>

                <h3 style="margin: 30px 0 15px;">Backup History</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Size</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="admin-backup-history">
                        <tr>
                            <td colspan="4" style="text-align: center;">Loading data...</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Notifications Content -->
            <div id="admin-notifications-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">Notifications</h2>
                    <div class="content-actions">
                        <button onclick="sendSystemNotification()"><i class="fas fa-plus"></i> Send Notification</button>
                    </div>
                </div>

                <h3 style="margin-bottom: 15px;">Send System Notification</h3>
                <div class="form-group">
                    <label>Recipient</label>
                    <select id="notification-recipient">
                        <option>All Users</option>
                        <option>All Students</option>
                        <option>All Faculty</option>
                        <option>All Administrators</option>
                        <option>Specific Users</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Title</label>
                    <input type="text" id="notification-title" placeholder="Enter notification title">
                </div>
                <div class="form-group">
                    <label>Message</label>
                    <textarea id="notification-message" placeholder="Enter notification message"></textarea>
                </div>
                <div class="form-group">
                    <label>Priority</label>
                    <select id="notification-priority">
                        <option>Low</option>
                        <option>Medium</option>
                        <option>High</option>
                        <option>Critical</option>
                    </select>
                </div>
                <button class="btn-primary" onclick="submitNotification()">Send Notification</button>

                <h3 style="margin: 30px 0 15px;">Recent System Notifications</h3>
                <div id="admin-notifications-list">
                    <div class="notification-item">
                        <div class="notification-icon"><i class="fas fa-spinner fa-spin"></i></div>
                        <div class="notification-content">
                            <h4>Loading notifications</h4>
                            <p>Please wait while we fetch the system notifications.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Content -->
            <div id="admin-settings-content" class="content-section">
                <div class="content-header">
                    <h2 class="content-title">System Settings</h2>
                </div>

                <h3 style="margin-bottom: 15px;">General Configuration</h3>
                <div class="form-group">
                    <label>Institution Name</label>
                    <input type="text" id="institution-name" value="University of Excellence">
                </div>
                <div class="form-group">
                    <label>Academic Year</label>
                    <select id="academic-year">
                        <option>2024-2025</option>
                        <option>2023-2024</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Timezone</label>
                    <select id="timezone">
                        <option>(GMT-05:00) Eastern Time (US & Canada)</option>
                        <option>(GMT-06:00) Central Time (US & Canada)</option>
                        <option>(GMT-07:00) Mountain Time (US & Canada)</option>
                        <option>(GMT-08:00) Pacific Time (US & Canada)</option>
                    </select>
                </div>

                <h3 style="margin: 20px 0 15px;">Attendance Settings</h3>
                <div class="form-group">
                    <label>Minimum Attendance Requirement</label>
                    <input type="number" id="min-attendance" value="75" min="0" max="100">%
                </div>
                <div class="form-group">
                    <label>Allow Late Check-in</label>
                    <select id="late-checkin">
                        <option>Yes</option>
                        <option>No</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Late Check-in Grace Period (minutes)</label>
                    <input type="number" id="grace-period" value="10" min="0">
                </div>

                <h3 style="margin: 20px 0 15px;">Notification Settings</h3>
                <div class="form-group">
                    <label>Email Notifications</label>
                    <select id="email-notifications-setting">
                        <option>Enabled</option>
                        <option>Disabled</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>SMS Notifications</label>
                    <select id="sms-notifications-setting">
                        <option>Enabled</option>
                        <option>Disabled</option>
                    </select>
                </div>

                <button class="btn-primary" style="margin-top: 20px;" onclick="saveSystemSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Register New Account</h2>
                <span class="close" onclick="closeRegisterForm()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="register-name" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="register-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="register-password" placeholder="Enter your password">
                </div>
                <div class="form-group">
                    <label>Confirm Password</label>
                    <input type="password" id="register-confirm-password" placeholder="Confirm your password">
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="register-role">
                        <option value="student">Student</option>
                        <option value="faculty">Faculty</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="closeRegisterForm()">Cancel</button>
                <button class="btn-primary" onclick="register()">Register</button>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_URL = 'http://localhost:3000/api';

        // Helper function for API requests
        async function apiRequest(endpoint, method = 'GET', data = null, requiresAuth = true) {
            const options = {
                method,
                headers: {
                    'Content-Type': 'application/json'
                }
            };

            if (requiresAuth) {
                const token = localStorage.getItem('token');
                if (!token) {
                    showNotification('Authentication required. Please login.', 'error');
                    logout();
                    return;
                }
                options.headers['Authorization'] = `Bearer ${token}`;
            }

            if (data) {
                options.body = JSON.stringify(data);
            }

            try {
                const response = await fetch(`${API_URL}${endpoint}`, options);
                const result = await response.json();

                if (!response.ok) {
                    throw new Error(result.message || 'Something went wrong');
                }

                return result;
            } catch (error) {
                showNotification(error.message, 'error');
                throw error;
            }
        }

        let role = '';
        let currentUser = null;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function () {
            createParticles();

            // Check if user is already logged in
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');

            if (token && user) {
                try {
                    currentUser = JSON.parse(user);
                    role = currentUser.role;

                    // Show the appropriate dashboard
                    document.getElementById('home').style.display = 'none';

                    if (role === 'student') {
                        document.getElementById('student-dashboard').style.display = 'flex';
                        showContent('student', 'dashboard');
                        loadStudentDashboard();
                    } else if (role === 'faculty') {
                        document.getElementById('faculty-dashboard').style.display = 'flex';
                        showContent('faculty', 'dashboard');
                        loadFacultyDashboard();
                    } else if (role === 'admin') {
                        document.getElementById('admin-dashboard').style.display = 'flex';
                        showContent('admin', 'dashboard');
                        loadAdminDashboard();
                    }
                } catch (error) {
                    // Invalid user data, clear storage
                    localStorage.removeItem('token');
                    localStorage.removeItem('user');
                }
            }

            // Add event listener for faculty announcement audience selection
            const audienceSelect = document.getElementById('faculty-announcement-audience');
            if (audienceSelect) {
                audienceSelect.addEventListener('change', function () {
                    const courseGroup = document.getElementById('faculty-announcement-course-group');
                    if (this.value === 'Specific Course') {
                        courseGroup.style.display = 'block';
                    } else {
                        courseGroup.style.display = 'none';
                    }
                });
            }
        });

        function showLogin(selectedRole) {
            role = selectedRole;
            document.getElementById('home').style.display = 'none';
            document.getElementById('login').style.display = 'flex';
            document.getElementById('login-title').innerText = selectedRole.charAt(0).toUpperCase() + selectedRole.slice(1) + ' Login';

            // Create water droplets effect
            createDroplets();
        }

        function backHome() {
            document.getElementById('login').style.display = 'none';
            document.getElementById('home').style.display = 'flex';

            // Remove droplets when going back to home
            const droplets = document.querySelectorAll('.droplet');
            droplets.forEach(droplet => droplet.remove());
        }

        async function login() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            // ADD THESE CONSOLE LOGS:
            console.log('Attempting login with:', { email, role, passwordLength: password.length });

            // Simple validation
            if (!email || !password) {
                showNotification('Please enter both email and password', 'error');
                return;
            }

            // ADD THIS CHECK:
            if (!role) {
                showNotification('Role not selected. Please go back and select a role.', 'error');
                return;
            }

            // Simulate login process
            showLoading();

            try {
                const response = await apiRequest('/auth/login', 'POST', { email, password, role }, false);
                hideLoading();

                // Store token and user info
                localStorage.setItem('token', response.token);
                localStorage.setItem('user', JSON.stringify(response.user));
                currentUser = response.user;

                document.getElementById('login').style.display = 'none';

                // Remove droplets when logging in
                const droplets = document.querySelectorAll('.droplet');
                droplets.forEach(droplet => droplet.remove());

                if (role === 'student') {
                    document.getElementById('student-dashboard').style.display = 'flex';
                    showContent('student', 'dashboard');
                    loadStudentDashboard();
                } else if (role === 'faculty') {
                    document.getElementById('faculty-dashboard').style.display = 'flex';
                    showContent('faculty', 'dashboard');
                    loadFacultyDashboard();
                } else if (role === 'admin') {
                    document.getElementById('admin-dashboard').style.display = 'flex';
                    showContent('admin', 'dashboard');
                    loadAdminDashboard();
                }

                showNotification(`Welcome back! You have successfully logged in as ${role}.`, 'success');
            } catch (error) {
                hideLoading();
                console.error('Login error:', error);
                // Error already shown by apiRequest
            }
        }

        function logout() {
            // Clear token and user info
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            currentUser = null;

            document.getElementById('student-dashboard').style.display = 'none';
            document.getElementById('faculty-dashboard').style.display = 'none';
            document.getElementById('admin-dashboard').style.display = 'none';
            document.getElementById('home').style.display = 'flex';

            showNotification('You have been successfully logged out.', 'info');
        }

        function toggleSidebar(userRole) {
            const sidebar = document.getElementById(userRole + '-sidebar');
            sidebar.classList.toggle('collapsed');
        }

        function showContent(userRole, contentId) {
            // Hide all content sections for this role
            const sections = document.querySelectorAll(`#${userRole}-dashboard .content-section`);
            sections.forEach(section => section.classList.remove('active'));

            // Show the selected content section
            document.getElementById(`${userRole}-${contentId}-content`).classList.add('active');

            // Update active state in sidebar
            const sidebarLinks = document.querySelectorAll(`#${userRole}-sidebar a`);
            sidebarLinks.forEach(link => link.classList.remove('active'));

            // Find and activate the clicked link
            const activeLink = Array.from(sidebarLinks).find(link =>
                link.getAttribute('onclick').includes(contentId)
            );
            if (activeLink) {
                activeLink.classList.add('active');
            }

            // Load content specific to the section
            if (userRole === 'student') {
                if (contentId === 'announcements') {
                    loadStudentAnnouncements();
                } else if (contentId === 'notifications') {
                    loadStudentNotifications();
                } else if (contentId === 'settings') {
                    loadStudentSettings();
                }
            } else if (userRole === 'faculty') {
                if (contentId === 'lecture-upload') {
                    loadFacultyCourses();
                } else if (contentId === 'attendance-management') {
                    loadFacultyAttendanceData();
                } else if (contentId === 'assignments-quiz') {
                    loadFacultyCoursesForAssignments();
                } else if (contentId === 'announcements') {
                    loadFacultyAnnouncements();
                    loadFacultyCoursesForAnnouncements();
                } else if (contentId === 'notifications') {
                    loadFacultyNotifications();
                }
            } else if (userRole === 'admin') {
                if (contentId === 'users') {
                    loadAdminUsers();
                } else if (contentId === 'administrators') {
                    loadAdminAdministrators();
                } else if (contentId === 'database') {
                    loadAdminDatabaseInfo();
                } else if (contentId === 'notifications') {
                    loadAdminNotifications();
                } else if (contentId === 'settings') {
                    loadAdminSettings();
                }
            }
        }

        // Function to create water droplets
        function createDroplets() {
            const loginContainer = document.getElementById('login');

            // Clear existing droplets
            const existingDroplets = loginContainer.querySelectorAll('.droplet');
            existingDroplets.forEach(droplet => droplet.remove());

            // Create new droplets
            for (let i = 0; i < 15; i++) {
                const droplet = document.createElement('div');
                droplet.classList.add('droplet');

                // Random size between 5px and 15px
                const size = Math.random() * 10 + 5;
                droplet.style.width = `${size}px`;
                droplet.style.height = `${size}px`;

                // Random position
                droplet.style.left = `${Math.random() * 100}%`;

                // Random animation duration between 5s and 15s
                const duration = Math.random() * 10 + 5;
                droplet.style.animationDuration = `${duration}s`;

                // Random delay
                const delay = Math.random() * 5;
                droplet.style.animationDelay = `${delay}s`;

                loginContainer.appendChild(droplet);
            }
        }

        // Function to create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('home-particles');

            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');

                // Random size between 3px and 8px
                const size = Math.random() * 5 + 3;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;

                // Random position
                particle.style.left = `${Math.random() * 100}%`;

                // Random animation duration between 10s and 20s
                const duration = Math.random() * 10 + 10;
                particle.style.animationDuration = `${duration}s`;

                // Random delay
                const delay = Math.random() * 5;
                particle.style.animationDelay = `${delay}s`;

                particlesContainer.appendChild(particle);
            }
        }

        // Student Dashboard Functions
        async function loadStudentDashboard() {
            try {
                // Get user info
                const userResponse = await apiRequest('/auth/me');
                const user = userResponse;

                // Get attendance data
                const attendanceResponse = await apiRequest('/attendance');
                const attendanceRecords = attendanceResponse;

                // Calculate attendance percentage
                const totalClasses = attendanceRecords.length;
                const presentClasses = attendanceRecords.filter(record => record.status === 'present').length;
                const attendancePercentage = totalClasses > 0 ? Math.round((presentClasses / totalClasses) * 100) : 0;

                // Get courses
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                // Update dashboard
                document.getElementById('student-attendance-percentage').textContent = attendancePercentage + '%';
                document.getElementById('student-attendance-progress').style.width = attendancePercentage + '%';
                document.getElementById('student-courses-count').textContent = courses.length;
                document.getElementById('student-upcoming-lectures').textContent = '3'; // This would be calculated from schedule

                // Update recent activity table
                const tbody = document.getElementById('student-recent-activity');
                tbody.innerHTML = '';

                // Get last 5 attendance records
                const recentAttendance = attendanceRecords
                    .sort((a, b) => new Date(b.date) - new Date(a.date))
                    .slice(0, 5);

                if (recentAttendance.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="3" style="text-align: center;">No attendance records found</td>';
                    tbody.appendChild(row);
                } else {
                    recentAttendance.forEach(record => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                            <td>${record.course.name}</td>
                                            <td>${new Date(record.date).toLocaleDateString()}</td>
                                            <td><span class="badge badge-${record.status === 'present' ? 'success' : 'danger'}">${record.status}</span></td>
                                        `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load dashboard data', 'error');
            }
        }

        async function loadStudentAnnouncements() {
            try {
                const announcementsResponse = await apiRequest('/announcements');
                const announcements = announcementsResponse;

                const announcementsList = document.getElementById('student-announcements-list');
                announcementsList.innerHTML = '';

                if (announcements.length === 0) {
                    announcementsList.innerHTML = `
                                        <div class="announcement-item">
                                            <div class="announcement-date">No announcements</div>
                                            <h3>No announcements available</h3>
                                            <p>There are no announcements at this time.</p>
                                        </div>
                                    `;
                } else {
                    announcements.forEach(announcement => {
                        const announcementItem = document.createElement('div');
                        announcementItem.className = 'announcement-item';
                        announcementItem.innerHTML = `
                                            <div class="announcement-date">${new Date(announcement.createdAt).toLocaleDateString()}</div>
                                            <h3>${announcement.title}</h3>
                                            <p>${announcement.content}</p>
                                        `;
                        announcementsList.appendChild(announcementItem);
                    });
                }
            } catch (error) {
                showNotification('Failed to load announcements', 'error');
            }
        }

        async function loadStudentNotifications() {
            try {
                // In a real app, you would have a notifications endpoint
                // For now, we'll simulate with some dummy data
                const notificationsList = document.getElementById('student-notifications-list');
                notificationsList.innerHTML = `
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-exclamation-circle"></i></div>
                                        <div class="notification-content">
                                            <h4>Assignment Due</h4>
                                            <p>Computer Science assignment is due tomorrow</p>
                                        </div>
                                        <div class="notification-time">2 hours ago</div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-calendar"></i></div>
                                        <div class="notification-content">
                                            <h4>Class Rescheduled</h4>
                                            <p>Calculus class moved to 3 PM today</p>
                                        </div>
                                        <div class="notification-time">5 hours ago</div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-trophy"></i></div>
                                        <div class="notification-content">
                                            <h4>Achievement Unlocked</h4>
                                            <p>You've maintained 90% attendance for 30 days!</p>
                                        </div>
                                        <div class="notification-time">1 day ago</div>
                                    </div>
                                `;
            } catch (error) {
                showNotification('Failed to load notifications', 'error');
            }
        }

        async function loadStudentSettings() {
            try {
                const userResponse = await apiRequest('/auth/me');
                const user = userResponse;

                document.getElementById('student-name').value = user.name;
                document.getElementById('student-email').value = user.email;
                document.getElementById('student-phone').value = user.phone || '';
            } catch (error) {
                showNotification('Failed to load settings', 'error');
            }
        }

        function refreshDashboard(userRole) {
            showNotification('Dashboard refreshed successfully', 'success');

            // Simulate data refresh
            const statValues = document.querySelectorAll(`#${userRole}-dashboard-content .stat-value`);
            statValues.forEach(stat => {
                // Add a subtle animation to indicate refresh
                stat.style.opacity = '0.5';
                setTimeout(() => {
                    stat.style.opacity = '1';
                }, 500);
            });

            // Reload dashboard data
            if (userRole === 'student') {
                loadStudentDashboard();
            } else if (userRole === 'faculty') {
                loadFacultyDashboard();
            } else if (userRole === 'admin') {
                loadAdminDashboard();
            }
        }

        function joinLecture(courseName) {
            showNotification(`Joining ${courseName} lecture...`, 'info');

            // Simulate joining lecture
            setTimeout(() => {
                showNotification(`You have successfully joined the ${courseName} lecture.`, 'success');
            }, 1500);
        }

        function watchLecture(courseName) {
            showNotification(`Opening ${courseName} lecture...`, 'info');

            // In a real app, you would open a modal or new page with the video player
            setTimeout(() => {
                showNotification(`${courseName} lecture is now playing.`, 'success');

                // Example of setting up video player
                const videoElement = document.createElement('video');
                videoElement.src = 'path/to/video.mp4';
                videoElement.controls = true;
                videoElement.style.width = '100%';

                // Add to DOM
                const container = document.createElement('div');
                container.style.position = 'fixed';
                container.style.top = '0';
                container.style.left = '0';
                container.style.width = '100%';
                container.style.height = '100%';
                container.style.backgroundColor = 'rgba(0,0,0,0.8)';
                container.style.zIndex = '1000';
                container.style.display = 'flex';
                container.style.justifyContent = 'center';
                container.style.alignItems = 'center';

                container.appendChild(videoElement);
                document.body.appendChild(container);

                // Setup anti-skip feature
                setupVideoPlayer(videoElement, 'lecture-id-here');

                // Close on click outside
                container.addEventListener('click', function (e) {
                    if (e.target === container) {
                        document.body.removeChild(container);
                    }
                });
            }, 1500);
        }

        function filterLectures() {
            showNotification('Filter options opened', 'info');
        }

        function searchLectures() {
            const searchTerm = prompt('Enter search term:');
            if (searchTerm) {
                showNotification(`Searching for lectures containing "${searchTerm}"...`, 'info');
            }
        }

        function downloadAttendanceReport() {
            showNotification('Preparing attendance report for download...', 'info');

            // Simulate download
            setTimeout(() => {
                showNotification('Attendance report downloaded successfully', 'success');
            }, 1500);
        }

        function createAnnouncement() {
            showNotification('Students cannot create announcements', 'warning');
        }

        function markAllAsRead() {
            const notificationItems = document.querySelectorAll('#student-notifications-content .notification-item');
            notificationItems.forEach(item => {
                item.style.opacity = '0.7';
            });

            showNotification('All notifications marked as read', 'success');
        }

        async function saveStudentSettings() {
            const name = document.getElementById('student-name').value;
            const email = document.getElementById('student-email').value;
            const phone = document.getElementById('student-phone').value;

            try {
                await apiRequest('/users/' + currentUser.id, 'PUT', { name, email, phone });
                showNotification('Settings saved successfully', 'success');
            } catch (error) {
                showNotification('Failed to save settings', 'error');
            }
        }

        // Faculty Dashboard Functions
        async function loadFacultyDashboard() {
            try {
                // Get user info
                const userResponse = await apiRequest('/auth/me');
                const user = userResponse;

                // Get courses
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                // Get students count
                let totalStudents = 0;
                courses.forEach(course => {
                    totalStudents += course.students.length;
                });

                // Get attendance data
                const attendanceResponse = await apiRequest('/attendance');
                const attendanceRecords = attendanceResponse;

                // Calculate average attendance
                const totalClasses = attendanceRecords.length;
                const presentClasses = attendanceRecords.filter(record => record.status === 'present').length;
                const avgAttendance = totalClasses > 0 ? Math.round((presentClasses / totalClasses) * 100) : 0;

                // Update dashboard
                document.getElementById('faculty-courses-count').textContent = courses.length;
                document.getElementById('faculty-students-count').textContent = totalStudents;
                document.getElementById('faculty-avg-attendance').textContent = avgAttendance + '%';
                document.getElementById('faculty-attendance-progress').style.width = avgAttendance + '%';

                // Update today's schedule table
                const tbody = document.getElementById('faculty-today-schedule');
                tbody.innerHTML = '';

                // Get today's classes
                const today = new Date().toLocaleDateString('en-US', { weekday: 'long' });
                const todayClasses = courses.filter(course => course.schedule && course.schedule.day === today);

                if (todayClasses.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="4" style="text-align: center;">No classes scheduled for today</td>';
                    tbody.appendChild(row);
                } else {
                    todayClasses.forEach(course => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                            <td>${course.schedule.time}</td>
                                            <td>${course.name}</td>
                                            <td>Room ${Math.floor(Math.random() * 300) + 100}</td>
                                            <td><span class="badge badge-warning">Upcoming</span></td>
                                        `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load dashboard data', 'error');
            }
        }

        async function loadFacultyCourses() {
            try {
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                const courseSelect = document.getElementById('lecture-course');
                courseSelect.innerHTML = '<option value="">Select a course</option>';

                courses.forEach(course => {
                    const option = document.createElement('option');
                    option.value = course._id;
                    option.textContent = course.name;
                    courseSelect.appendChild(option);
                });
            } catch (error) {
                showNotification('Failed to load courses', 'error');
            }
        }

        async function loadFacultyAttendanceData() {
            try {
                // Get courses
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                // Get attendance data
                const attendanceResponse = await apiRequest('/attendance');
                const attendanceRecords = attendanceResponse;

                // Calculate stats
                let totalStudents = 0;
                courses.forEach(course => {
                    totalStudents += course.students.length;
                });

                const totalClasses = attendanceRecords.length;
                const presentClasses = attendanceRecords.filter(record => record.status === 'present').length;
                const avgAttendance = totalClasses > 0 ? Math.round((presentClasses / totalClasses) * 100) : 0;

                // Update stats
                document.getElementById('faculty-today-classes').textContent = courses.length;
                document.getElementById('faculty-total-students').textContent = totalStudents;
                document.getElementById('faculty-avg-attendance-value').textContent = avgAttendance + '%';
                document.getElementById('faculty-avg-attendance-progress').style.width = avgAttendance + '%';

                // Update attendance records table
                const tbody = document.getElementById('faculty-attendance-records');
                tbody.innerHTML = '';

                // Group attendance by course and date
                const attendanceByCourse = {};
                attendanceRecords.forEach(record => {
                    const courseId = record.course._id;
                    const date = new Date(record.date).toLocaleDateString();

                    if (!attendanceByCourse[courseId]) {
                        attendanceByCourse[courseId] = {};
                    }

                    if (!attendanceByCourse[courseId][date]) {
                        attendanceByCourse[courseId][date] = {
                            course: record.course.name,
                            date: date,
                            total: 0,
                            present: 0,
                            absent: 0
                        };
                    }

                    attendanceByCourse[courseId][date].total++;
                    if (record.status === 'present') {
                        attendanceByCourse[courseId][date].present++;
                    } else {
                        attendanceByCourse[courseId][date].absent++;
                    }
                });

                // Convert to array and sort by date
                const attendanceArray = [];
                Object.keys(attendanceByCourse).forEach(courseId => {
                    Object.keys(attendanceByCourse[courseId]).forEach(date => {
                        attendanceArray.push(attendanceByCourse[courseId][date]);
                    });
                });

                attendanceArray.sort((a, b) => new Date(b.date) - new Date(a.date));

                // Display last 5 records
                const recentAttendance = attendanceArray.slice(0, 5);

                if (recentAttendance.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="7" style="text-align: center;">No attendance records found</td>';
                    tbody.appendChild(row);
                } else {
                    recentAttendance.forEach(record => {
                        const percentage = record.total > 0 ? Math.round((record.present / record.total) * 100) : 0;
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                            <td>${record.course}</td>
                                            <td>${record.date}</td>
                                            <td>${record.total}</td>
                                            <td>${record.present}</td>
                                            <td>${record.absent}</td>
                                            <td>${percentage}%</td>
                                            <td><button class="btn-secondary" onclick="viewAttendanceDetails('${record.course}')">View Details</button></td>
                                        `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load attendance data', 'error');
            }
        }

        async function loadFacultyCoursesForAssignments() {
            try {
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                const courseSelect = document.getElementById('assignment-course');
                courseSelect.innerHTML = '<option value="">Select a course</option>';

                courses.forEach(course => {
                    const option = document.createElement('option');
                    option.value = course._id;
                    option.textContent = course.name;
                    courseSelect.appendChild(option);
                });
            } catch (error) {
                showNotification('Failed to load courses', 'error');
            }
        }

        async function loadFacultyAnnouncements() {
            try {
                const announcementsResponse = await apiRequest('/announcements');
                const announcements = announcementsResponse;

                const announcementsList = document.getElementById('faculty-announcements-list');
                announcementsList.innerHTML = '';

                if (announcements.length === 0) {
                    announcementsList.innerHTML = `
                                        <div class="announcement-item">
                                            <div class="announcement-date">No announcements</div>
                                            <h3>No announcements available</h3>
                                            <p>There are no announcements at this time.</p>
                                        </div>
                                    `;
                } else {
                    announcements.forEach(announcement => {
                        const announcementItem = document.createElement('div');
                        announcementItem.className = 'announcement-item';
                        announcementItem.innerHTML = `
                                            <div class="announcement-date">${new Date(announcement.createdAt).toLocaleDateString()}</div>
                                            <h3>${announcement.title}</h3>
                                            <p>${announcement.content}</p>
                                        `;
                        announcementsList.appendChild(announcementItem);
                    });
                }
            } catch (error) {
                showNotification('Failed to load announcements', 'error');
            }
        }

        async function loadFacultyCoursesForAnnouncements() {
            try {
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                const courseSelect = document.getElementById('faculty-announcement-course');
                courseSelect.innerHTML = '<option value="">Select a course</option>';

                courses.forEach(course => {
                    const option = document.createElement('option');
                    option.value = course._id;
                    option.textContent = course.name;
                    courseSelect.appendChild(option);
                });
            } catch (error) {
                showNotification('Failed to load courses', 'error');
            }
        }

        async function loadFacultyNotifications() {
            try {
                // In a real app, you would have a notifications endpoint
                // For now, we'll simulate with some dummy data
                const notificationsList = document.getElementById('faculty-notifications-list');
                notificationsList.innerHTML = `
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-user-graduate"></i></div>
                                        <div class="notification-content">
                                            <h4>New Student Enrollment</h4>
                                            <p>5 new students have enrolled in your Computer Programming course</p>
                                        </div>
                                        <div class="notification-time">1 day ago</div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-tasks"></i></div>
                                        <div class="notification-content">
                                            <h4>Assignment Submission</h4>
                                            <p>3 students have submitted the Algorithm Analysis assignment</p>
                                        </div>
                                        <div class="notification-time">2 days ago</div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-calendar"></i></div>
                                        <div class="notification-content">
                                            <h4>Class Cancellation</h4>
                                            <p>Your Calculus class on October 20 has been cancelled</p>
                                        </div>
                                        <div class="notification-time">3 days ago</div>
                                    </div>
                                `;
            } catch (error) {
                showNotification('Failed to load notifications', 'error');
            }
        }

        async function uploadLecture() {
            const courseId = document.getElementById('lecture-course').value;
            const title = document.getElementById('lecture-title').value;
            const description = document.getElementById('lecture-description').value;

            if (!courseId || !title) {
                showNotification('Please select a course and enter a lecture title', 'error');
                return;
            }

            showNotification('Uploading lecture...', 'info');

            try {
                // In a real app, you would upload the video file to a storage service
                // and then save the lecture metadata to the database
                // For now, we'll just simulate the upload

                // Simulate upload delay
                await new Promise(resolve => setTimeout(resolve, 2000));

                showNotification(`Lecture "${title}" uploaded successfully`, 'success');

                // Reset form
                document.getElementById('lecture-course').value = '';
                document.getElementById('lecture-title').value = '';
                document.getElementById('lecture-description').value = '';

                // Reload recent lectures
                // In a real app, you would fetch the updated list from the API
            } catch (error) {
                showNotification('Failed to upload lecture', 'error');
            }
        }

        async function markAttendance() {
            try {
                // Get courses for this faculty
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                if (courses.length === 0) {
                    showNotification('No courses found', 'error');
                    return;
                }

                // For simplicity, we'll use the first course
                const course = courses[0];

                // Get students for this course
                const students = course.students;

                if (students.length === 0) {
                    showNotification('No students enrolled in this course', 'error');
                    return;
                }

                // Mark attendance for all students (in a real app, this would be more interactive)
                const today = new Date().toISOString().split('T')[0];

                for (const student of students) {
                    await apiRequest('/attendance', 'POST', {
                        courseId: course._id,
                        studentId: student._id,
                        date: today,
                        status: Math.random() > 0.2 ? 'present' : 'absent' // Random status for demo
                    });
                }

                showNotification('Attendance marked successfully', 'success');
                loadFacultyDashboard(); // Refresh dashboard
            } catch (error) {
                showNotification('Failed to mark attendance', 'error');
            }
        }

        function viewAttendanceDetails(courseName) {
            showNotification(`Loading attendance details for ${courseName}...`, 'info');

            // Simulate loading details
            setTimeout(() => {
                showNotification(`Attendance details for ${courseName} loaded successfully`, 'success');
            }, 1500);
        }

        function createAssignment() {
            showNotification('Assignment creation form opened', 'info');
        }

        async function submitAssignment() {
            const courseId = document.getElementById('assignment-course').value;
            const title = document.getElementById('assignment-title').value;
            const description = document.getElementById('assignment-description').value;
            const dueDate = document.getElementById('assignment-due-date').value;

            if (!courseId || !title) {
                showNotification('Please select a course and enter an assignment title', 'error');
                return;
            }

            showNotification('Creating assignment...', 'info');

            try {
                await apiRequest('/assignments', 'POST', {
                    title,
                    description,
                    courseId,
                    dueDate
                });

                showNotification(`Assignment "${title}" created successfully`, 'success');

                // Reset form
                document.getElementById('assignment-course').value = '';
                document.getElementById('assignment-title').value = '';
                document.getElementById('assignment-description').value = '';
                document.getElementById('assignment-due-date').value = '';

                // Reload active assignments
                loadFacultyActiveAssignments();
            } catch (error) {
                showNotification('Failed to create assignment', 'error');
            }
        }

        async function loadFacultyActiveAssignments() {
            try {
                const coursesResponse = await apiRequest('/courses');
                const courses = coursesResponse;

                let allAssignments = [];

                for (const course of courses) {
                    const assignmentsResponse = await apiRequest(`/assignments/course/${course._id}`);
                    const assignments = assignmentsResponse.map(a => ({ ...a, courseName: course.name }));
                    allAssignments = [...allAssignments, ...assignments];
                }

                const tbody = document.getElementById('faculty-active-assignments');
                tbody.innerHTML = '';

                if (allAssignments.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="5" style="text-align: center;">No active assignments</td>';
                    tbody.appendChild(row);
                } else {
                    allAssignments.forEach(assignment => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                        <td>${assignment.title}</td>
                                        <td>${assignment.courseName}</td>
                                        <td>${new Date(assignment.due_date).toLocaleDateString()}</td>
                                        <td>${Math.floor(Math.random() * 30) + 1}</td>
                                        <td><button class="btn-secondary" onclick="viewSubmissions('${assignment.title}')">View Submissions</button></td>
                                    `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load assignments', 'error');
            }
        }

        function viewSubmissions(assignmentName) {
            showNotification(`Loading submissions for "${assignmentName}"...`, 'info');

            // Simulate loading submissions
            setTimeout(() => {
                showNotification(`Submissions for "${assignmentName}" loaded successfully`, 'success');
            }, 1500);
        }

        async function createFacultyAnnouncement() {
            const title = document.getElementById('faculty-announcement-title').value;
            const message = document.getElementById('faculty-announcement-message').value;
            const audience = document.getElementById('faculty-announcement-audience').value;
            const courseId = document.getElementById('faculty-announcement-course').value;

            if (!title || !message) {
                showNotification('Please enter both title and message', 'error');
                return;
            }

            if (audience === 'Specific Course' && !courseId) {
                showNotification('Please select a course', 'error');
                return;
            }

            showNotification('Posting announcement...', 'info');

            try {
                const targetAudience = audience === 'All Students' ? 'students' : 'specific';
                const targetCourses = audience === 'Specific Course' ? [courseId] : [];

                await apiRequest('/announcements', 'POST', {
                    title,
                    content: message,
                    targetAudience,
                    targetCourses
                });

                showNotification('Announcement posted successfully', 'success');

                // Reset form
                document.getElementById('faculty-announcement-title').value = '';
                document.getElementById('faculty-announcement-message').value = '';
                document.getElementById('faculty-announcement-audience').value = 'All Students';
                document.getElementById('faculty-announcement-course').value = '';

                // Reload announcements
                loadFacultyAnnouncements();
            } catch (error) {
                showNotification('Failed to post announcement', 'error');
            }
        }

        function markFacultyNotificationsAsRead() {
            const notificationItems = document.querySelectorAll('#faculty-notifications-content .notification-item');
            notificationItems.forEach(item => {
                item.style.opacity = '0.7';
            });

            showNotification('All notifications marked as read', 'success');
        }

        // Admin Dashboard Functions
        // Admin Dashboard Functions
        async function loadAdminDashboard() {
            try {
                console.log('Loading admin dashboard...');
                showLoading();

                // Load user counts
                const countsResponse = await apiRequest('/users/counts', 'GET');
                console.log('User counts:', countsResponse);

                // Update stats
                document.getElementById('admin-total-users').textContent = countsResponse.total || 0;
                document.getElementById('admin-students-count').textContent = countsResponse.students || 0;
                document.getElementById('admin-faculty-count').textContent = countsResponse.faculty || 0;
                document.getElementById('admin-admins-count').textContent = countsResponse.admins || 0;

                // Load all users
                console.log('Loading users...');
                const usersResponse = await apiRequest('/users', 'GET');
                console.log('Users loaded:', usersResponse.length);
                displayUsers(usersResponse);

                // Load database tables
                try {
                    const tablesResponse = await apiRequest('/database/tables', 'GET');
                    displayTables(tablesResponse);
                } catch (error) {
                    console.error('Failed to load tables:', error);
                }

                // Load backup history
                try {
                    const backupsResponse = await apiRequest('/database/backups', 'GET');
                    displayBackups(backupsResponse);
                } catch (error) {
                    console.error('Failed to load backups:', error);
                }

                // Update system overview table
                const tbody = document.getElementById('admin-system-overview');
                if (tbody) {
                    tbody.innerHTML = '';
                    const systems = [
                        { name: 'User Authentication', status: 'Operational', lastUpdated: new Date().toLocaleDateString() },
                        { name: 'Attendance System', status: 'Operational', lastUpdated: new Date().toLocaleDateString() },
                        { name: 'Lecture Streaming', status: 'Maintenance', lastUpdated: new Date(Date.now() - 86400000).toLocaleDateString() }
                    ];
                    systems.forEach(system => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${system.name}</td>
                            <td><span class="badge badge-${system.status === 'Operational' ? 'success' : 'warning'}">${system.status}</span></td>
                            <td>${system.lastUpdated}</td>
                            <td><button class="btn-secondary" onclick="viewSystemDetails('${system.name}')">View Details</button></td>
                        `;
                        tbody.appendChild(row);
                    });
                }

                hideLoading();
                showNotification('Admin dashboard loaded successfully', 'success');
            } catch (error) {
                hideLoading();
                console.error('Error loading admin dashboard:', error);
                showNotification('Failed to load admin dashboard: ' + error.message, 'error');
            }
        }

        async function loadAdminUsers() {
            try {
                const usersResponse = await apiRequest('/users');
                const users = usersResponse;
                displayUsers(users);
            } catch (error) {
                showNotification('Failed to load users', 'error');
            }
        }

        // Display users in table (with full error handling)
        function displayUsers(users) {
            // Try multiple ways to find the tbody
            let tbody = document.querySelector('#admin-users-table tbody');

            if (!tbody) {
                // Try finding table first, then tbody
                const table = document.getElementById('admin-users-table');
                if (table) {
                    tbody = table.querySelector('tbody');
                    if (!tbody) {
                        // If tbody doesn't exist, use table itself
                        tbody = table;
                    }
                }
            }

            if (!tbody) {
                console.error('Users table not found! Available tables:',
                    Array.from(document.querySelectorAll('table')).map(t => t.id || t.className));
                showNotification('Users table not found in HTML', 'error');
                return;
            }

            console.log('Users table found:', tbody);
            tbody.innerHTML = '';

            if (!users || users.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 20px;">No users found</td></tr>';
                return;
            }

            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td><span class="badge badge-${user.role}">${user.role}</span></td>
                    <td>${user.phone || 'N/A'}</td>
                    <td>
                        <button class="btn-secondary" style="margin-right: 5px;" onclick="editUser(${user.id})">Edit</button>
                        <button class="btn-secondary" style="background-color: #dc3545; color: white;" onclick="deleteUser(${user.id})">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            console.log(`Successfully displayed ${users.length} users`);
        }

        // Display database tables
        function displayTables(tables) {
            const tbody = document.querySelector('#admin-db-tables tbody');
            if (!tbody) return;

            tbody.innerHTML = '';

            if (!tables || tables.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px;">No tables found</td></tr>';
                return;
            }

            tables.forEach(table => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${table.name}</td>
                    <td>${table.rows || 0}</td>
                    <td>-</td>
                    <td>${new Date().toLocaleDateString()}</td>
                    <td><button class="btn-secondary" onclick="viewTable('${table.name}')">View</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Display backup history
        function displayBackups(backups) {
            const tbody = document.querySelector('#admin-backup-history tbody');
            if (!tbody) return;

            tbody.innerHTML = '';

            if (!backups || backups.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 20px;">No backups found</td></tr>';
                return;
            }

            backups.forEach(backup => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(backup.date).toLocaleString()}</td>
                    <td>${backup.size}</td>
                    <td><span class="badge badge-success">${backup.status}</span></td>
                    <td><button class="btn-secondary" onclick="downloadBackup('${backup.name}')">Download</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        // Delete user function
        async function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user?')) {
                return;
            }

            try {
                showLoading();
                await apiRequest(`/users/${userId}`, 'DELETE');
                hideLoading();
                showNotification('User deleted successfully', 'success');
                loadAdminDashboard();
            } catch (error) {
                hideLoading();
                showNotification('Failed to delete user', 'error');
            }
        }

        // Edit user function (already exists in your code, but make sure it's there)
        function editUser(userId) {
            showNotification(`Opening edit form for user ${userId}...`, 'info');
        }

        async function loadAdminAdministrators() {
            try {
                const usersResponse = await apiRequest('/users');
                const users = usersResponse;
                const administrators = users.filter(user => user.role === 'admin');

                const tbody = document.getElementById('admin-administrators-table');
                tbody.innerHTML = '';

                if (administrators.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="5" style="text-align: center;">No administrators found</td>';
                    tbody.appendChild(row);
                } else {
                    administrators.forEach(admin => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                            <td>${admin.name}</td>
                                            <td>${admin.email}</td>
                                            <td>Administrator</td>
                                            <td>${new Date().toLocaleDateString()}</td>
                                            <td>
                                                <button class="btn-secondary" style="margin-right: 5px;" onclick="editAdministrator('${admin._id}')">Edit</button>
                                                <button class="btn-secondary" style="background-color: #dc3545; color: white;" onclick="removeAdministrator('${admin._id}')">Remove</button>
                                            </td>
                                        `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load administrators', 'error');
            }
        }

        async function loadAdminDatabaseInfo() {
            try {
                const dbInfoResponse = await apiRequest('/database/info');
                const dbInfo = dbInfoResponse;

                // Update stats
                document.getElementById('admin-db-size').textContent = dbInfo.dbSize;
                document.getElementById('admin-last-backup').textContent = dbInfo.lastBackup;
                document.getElementById('admin-backup-status').textContent = 'Completed';
                document.getElementById('admin-backup-status').style.color = '#28a745';

                // Update database tables
                const tbody = document.getElementById('admin-db-tables');
                tbody.innerHTML = '';

                dbInfo.tables.forEach(table => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                                    <td>${table.table}</td>
                                    <td>-</td>
                                    <td>${table.size} MB</td>
                                    <td>${new Date().toLocaleDateString()}</td>
                                    <td><button class="btn-secondary" onclick="viewTable('${table.table}')">View</button></td>
                                `;
                    tbody.appendChild(row);
                });

                // Update backup history
                const backupTbody = document.getElementById('admin-backup-history');
                backupTbody.innerHTML = '';

                if (dbInfo.backups.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = '<td colspan="4" style="text-align: center;">No backups found</td>';
                    backupTbody.appendChild(row);
                } else {
                    dbInfo.backups.forEach(backup => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                                        <td>${new Date(backup.date).toLocaleDateString()}</td>
                                        <td>${backup.size}</td>
                                        <td><span class="badge badge-success">${backup.status}</span></td>
                                        <td><button class="btn-secondary" onclick="downloadBackup('${backup.date}')">Download</button></td>
                                    `;
                        backupTbody.appendChild(row);
                    });
                }
            } catch (error) {
                showNotification('Failed to load database information', 'error');
            }
        }

        async function loadAdminNotifications() {
            try {
                // In a real app, you would fetch system notifications from the API
                // For now, we'll simulate with some dummy data
                const notificationsList = document.getElementById('admin-notifications-list');
                notificationsList.innerHTML = `
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-exclamation-triangle"></i></div>
                                        <div class="notification-content">
                                            <h4>System Maintenance</h4>
                                            <p>The system will undergo maintenance on October 20, 2025 from 2 AM to 5 AM. Services may be unavailable during this period.</p>
                                        </div>
                                        <div class="notification-time">Oct 15, 2025</div>
                                    </div>
                                    <div class="notification-item">
                                        <div class="notification-icon"><i class="fas fa-info-circle"></i></div>
                                        <div class="notification-content">
                                            <h4>New Feature Release</h4>
                                            <p>We've released a new feature for advanced attendance analytics. Check it out in your dashboard.</p>
                                        </div>
                                        <div class="notification-time">Oct 12, 2025</div>
                                    </div>
                                `;
            } catch (error) {
                showNotification('Failed to load notifications', 'error');
            }
        }

        async function loadAdminSettings() {
            try {
                const settingsResponse = await apiRequest('/settings');
                const settings = settingsResponse;

                document.getElementById('institution-name').value = settings.institutionName || '';
                document.getElementById('academic-year').value = settings.academicYear || '';
                document.getElementById('timezone').value = settings.timezone || '';
                document.getElementById('min-attendance').value = settings.minAttendance || '';
                document.getElementById('late-checkin').value = settings.lateCheckin || '';
                document.getElementById('grace-period').value = settings.gracePeriod || '';
                document.getElementById('email-notifications-setting').value = settings.emailNotifications || '';
                document.getElementById('sms-notifications-setting').value = settings.smsNotifications || '';
            } catch (error) {
                showNotification('Failed to load settings', 'error');
            }
        }

        async function backupDatabase() {
            showNotification('Starting database backup...', 'info');

            try {
                const response = await apiRequest('/database/backup', 'POST');
                showNotification('Database backup completed successfully', 'success');
                loadAdminDatabaseInfo();
            } catch (error) {
                showNotification('Failed to backup database', 'error');
            }
        }

        async function restoreDatabase() {
            if (confirm('Are you sure you want to restore the database? This will overwrite current data.')) {
                showNotification('Starting database restore...', 'info');

                try {
                    // In a real app, you would select a backup file
                    const backupFile = prompt('Enter backup file path:');
                    if (!backupFile) return;

                    await apiRequest('/database/restore', 'POST', { backupFile });
                    showNotification('Database restored successfully', 'success');
                } catch (error) {
                    showNotification('Failed to restore database', 'error');
                }
            }
        }

        function addUser() {
            const name = prompt('Enter user name:');
            if (!name) return;

            const email = prompt('Enter user email:');
            if (!email) return;

            const password = prompt('Enter user password:');
            if (!password) return;

            const role = prompt('Enter user role (student/faculty/admin):');
            if (!role || !['student', 'faculty', 'admin'].includes(role)) {
                showNotification('Invalid role', 'error');
                return;
            }

            // In a real implementation, you would make an API call to create the user
            showNotification(`User ${name} created successfully`, 'success');
            loadAdminUsers();
        }

        function exportUsers() {
            showNotification('Preparing user data for export...', 'info');

            // Simulate export
            setTimeout(() => {
                showNotification('User data exported successfully', 'success');
            }, 1500);
        }

        function searchUsers() {
            const searchTerm = document.getElementById('user-search').value;
            if (searchTerm) {
                showNotification(`Searching for users matching "${searchTerm}"...`, 'info');
            }
        }

        function editUser(userId) {
            showNotification(`Opening edit form for user ${userId}...`, 'info');
        }

        function disableUser(userId) {
            if (confirm(`Are you sure you want to disable user ${userId}?`)) {
                showNotification(`Disabling user ${userId}...`, 'info');

                // Simulate disabling
                setTimeout(() => {
                    showNotification(`User ${userId} disabled successfully`, 'success');
                    loadAdminUsers();
                }, 1500);
            }
        }

        function addAdministrator() {
            showNotification('Administrator creation form opened', 'info');
        }

        async function submitAdministrator() {
            const name = document.getElementById('admin-name').value;
            const email = document.getElementById('admin-email').value;
            const role = document.getElementById('admin-role').value;

            if (!name || !email) {
                showNotification('Please enter both name and email', 'error');
                return;
            }

            try {
                // Register the user as an admin
                await apiRequest('/auth/register', 'POST', {
                    name,
                    email,
                    password: 'defaultpassword', // In a real app, you would generate a secure password
                    role: 'admin'
                }, false);

                showNotification(`Administrator account for ${name} created successfully`, 'success');

                // Reset form
                document.getElementById('admin-name').value = '';
                document.getElementById('admin-email').value = '';

                // Refresh administrators list
                loadAdminAdministrators();
            } catch (error) {
                showNotification('Failed to create administrator', 'error');
            }
        }

        function editAdministrator(adminName) {
            showNotification(`Opening edit form for administrator ${adminName}...`, 'info');
        }

        function removeAdministrator(adminId) {
            if (confirm(`Are you sure you want to remove administrator ${adminId}?`)) {
                showNotification(`Removing administrator ${adminId}...`, 'info');

                // Simulate removal
                setTimeout(() => {
                    showNotification(`Administrator ${adminId} removed successfully`, 'success');
                    loadAdminAdministrators();
                }, 1500);
            }
        }

        function viewTable(tableName) {
            showNotification(`Loading data for table ${tableName}...`, 'info');

            // Simulate loading table data
            setTimeout(() => {
                showNotification(`Data for table ${tableName} loaded successfully`, 'success');
            }, 1500);
        }

        function downloadBackup(backupDate) {
            showNotification(`Preparing backup from ${backupDate} for download...`, 'info');

            // Simulate download
            setTimeout(() => {
                showNotification(`Backup from ${backupDate} downloaded successfully`, 'success');
            }, 1500);
        }

        function sendSystemNotification() {
            showNotification('System notification form opened', 'info');
        }

        async function submitNotification() {
            const recipient = document.getElementById('notification-recipient').value;
            const title = document.getElementById('notification-title').value;
            const message = document.getElementById('notification-message').value;
            const priority = document.getElementById('notification-priority').value;

            if (!title || !message) {
                showNotification('Please enter both title and message', 'error');
                return;
            }

            showNotification('Sending notification...', 'info');

            try {
                // In a real app, you would save the notification to the database
                // For now, we'll just simulate it

                // Simulate sending
                await new Promise(resolve => setTimeout(resolve, 1500));

                showNotification('Notification sent successfully', 'success');

                // Reset form
                document.getElementById('notification-title').value = '';
                document.getElementById('notification-message').value = '';

                // Refresh notifications list
                loadAdminNotifications();
            } catch (error) {
                showNotification('Failed to send notification', 'error');
            }
        }

        function viewSystemDetails(componentName) {
            showNotification(`Loading details for ${componentName}...`, 'info');

            // Simulate loading details
            setTimeout(() => {
                showNotification(`Details for ${componentName} loaded successfully`, 'success');
            }, 1500);
        }

        async function saveSystemSettings() {
            const institutionName = document.getElementById('institution-name').value;
            const academicYear = document.getElementById('academic-year').value;
            const timezone = document.getElementById('timezone').value;
            const minAttendance = document.getElementById('min-attendance').value;
            const lateCheckin = document.getElementById('late-checkin').value;
            const gracePeriod = document.getElementById('grace-period').value;
            const emailNotifications = document.getElementById('email-notifications-setting').value;
            const smsNotifications = document.getElementById('sms-notifications-setting').value;

            try {
                await apiRequest('/settings', 'PUT', {
                    institutionName,
                    academicYear,
                    timezone,
                    minAttendance,
                    lateCheckin,
                    gracePeriod,
                    emailNotifications,
                    smsNotifications
                });

                showNotification('System settings saved successfully', 'success');
            } catch (error) {
                showNotification('Failed to save system settings', 'error');
            }
        }

        // Register Form Functions
        function showRegisterForm() {
            document.getElementById('register-modal').style.display = 'block';
        }

        function closeRegisterForm() {
            document.getElementById('register-modal').style.display = 'none';
        }

        async function register() {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;
            const role = document.getElementById('register-role').value;

            if (!name || !email || !password || !confirmPassword) {
                showNotification('Please fill in all fields', 'error');
                return;
            }

            if (password !== confirmPassword) {
                showNotification('Passwords do not match', 'error');
                return;
            }

            try {
                await apiRequest('/auth/register', 'POST', {
                    name,
                    email,
                    password,
                    role
                }, false);

                showNotification('Registration successful! Please login.', 'success');
                closeRegisterForm();
            } catch (error) {
                showNotification('Registration failed', 'error');
            }
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.position = 'fixed';
            notification.style.bottom = '20px';
            notification.style.right = '20px';
            notification.style.padding = '15px 20px';
            notification.style.borderRadius = '5px';
            notification.style.color = 'white';
            notification.style.fontWeight = '500';
            notification.style.zIndex = '1000';
            notification.style.minWidth = '250px';
            notification.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
            notification.style.transform = 'translateX(400px)';
            notification.style.transition = 'transform 0.3s ease';

            // Set background color based on type
            switch (type) {
                case 'success':
                    notification.style.backgroundColor = '#28a745';
                    break;
                case 'error':
                    notification.style.backgroundColor = '#dc3545';
                    break;
                case 'warning':
                    notification.style.backgroundColor = '#ffc107';
                    notification.style.color = '#212529';
                    break;
                default: // info
                    notification.style.backgroundColor = '#17a2b8';
            }

            // Set message
            notification.textContent = message;

            // Add to DOM
            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);

            // Remove after delay
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        function showLoading() {
            // Create loading overlay
            const loading = document.createElement('div');
            loading.id = 'loading-overlay';
            loading.style.position = 'fixed';
            loading.style.top = '0';
            loading.style.left = '0';
            loading.style.width = '100%';
            loading.style.height = '100%';
            loading.style.backgroundColor = 'rgba(0,0,0,0.5)';
            loading.style.display = 'flex';
            loading.style.justifyContent = 'center';
            loading.style.alignItems = 'center';
            loading.style.zIndex = '2000';

            // Add spinner
            const spinner = document.createElement('div');
            spinner.className = 'loading';
            spinner.style.width = '50px';
            spinner.style.height = '50px';
            spinner.style.borderWidth = '5px';

            loading.appendChild(spinner);
            document.body.appendChild(loading);
        }

        function hideLoading() {
            const loading = document.getElementById('loading-overlay');
            if (loading) {
                document.body.removeChild(loading);
            }
        }

        // Add ripple effect to buttons
        document.addEventListener('DOMContentLoaded', function () {
            const buttons = document.querySelectorAll('button');

            buttons.forEach(button => {
                button.addEventListener('click', function (e) {
                    const ripple = document.createElement('span');
                    ripple.classList.add('ripple');

                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;

                    ripple.style.width = ripple.style.height = size + 'px';
                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';

                    this.appendChild(ripple);

                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });
            });
        });

        // Close modal when clicking outside of it
        window.onclick = function (event) {
            const modal = document.getElementById('register-modal');
            if (event.target === modal) {
                closeRegisterForm();
            }
        }

        // Video Player Anti-Skip Feature
        function setupVideoPlayer(videoElement, lectureId) {
            let lastUpdateTime = 0;
            let updateInterval;

            // Get saved progress from localStorage
            const savedProgress = localStorage.getItem(`video-progress-${lectureId}`);
            if (savedProgress) {
                lastUpdateTime = parseFloat(savedProgress);
                videoElement.currentTime = lastUpdateTime;
            }

            // Update progress every 5 seconds
            updateInterval = setInterval(() => {
                if (!videoElement.paused && !videoElement.ended) {
                    lastUpdateTime = videoElement.currentTime;
                    localStorage.setItem(`video-progress-${lectureId}`, lastUpdateTime);
                }
            }, 5000);

            // Prevent skipping ahead
            videoElement.addEventListener('seeked', function () {
                if (videoElement.currentTime > lastUpdateTime + 5) {
                    videoElement.currentTime = lastUpdateTime;
                    showNotification('Skipping ahead is not allowed', 'warning');
                }
            });

            // Cleanup when video ends
            videoElement.addEventListener('ended', function () {
                clearInterval(updateInterval);
                localStorage.removeItem(`video-progress-${lectureId}`);
            });
        }
    </script>
</body>
</html>
